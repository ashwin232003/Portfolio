<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4shWIN-EscapeTwo HTB</title>
    <link rel="icon" type="image/png" href="https://labs.hackthebox.com/storage/avatars/d5fcf2425893a73cf137284e2de580e1.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../writeup.css">
    </head>
<body>
    <!-- Socials -->
    <div class="socials">
        <a href="https://www.linkedin.com/in/ashwin2305/" target="_blank"><i class="fab fa-linkedin"></i></a>
        <a href="https://app.hackthebox.com/profile/1979366" target="_blank">
            <svg style="width: 24px; height: 24px;" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <title>Hack The Box</title>
                <path d="M11.9959.0008a1.1187 1.1187 0 00-.057.002.8993.8993 0 00-.2358.0498.9067.9067 0 00-.1652.079L1.9357 5.675a.889.889 0 00-.4444.7699c0 .006.0004.0128.0006.0192-.0002.007 0 .014 0 .0212V17.556a.889.889 0 00.469.7837l9.5983 5.5416c.018.0102.036.0197.054.0287v.002a.8568.8568 0 00.083.0348c0 .001.01.003.012.004.028.01.056.0177.085.0245.01.001.011.003.016.004.028.006.057.0112.086.0146 0 .0005.01.0009.014.001.03.003.061.005.091.005s.061-.002.091-.005c0-.0005.01-.0009.014-.001a.6831.6831 0 00.086-.0146c.01-.001.011-.002.016-.004a.9404.9404 0 00.085-.0245c0-.001.01-.003.012-.004a.8818.8818 0 00.083-.0347v-.002a1.086 1.086 0 00.054-.0287l9.5986-5.5416a.889.889 0 00.4689-.7837V6.4786c0-.009-.0006-.0172-.0008-.0258h.0003v-.008a.8886.8886 0 00-.3117-.6755c-.01-.008-.019-.0162-.029-.0241 0-.002-.01-.005-.01-.007a.8988.8988 0 00-.1074-.0705L12.4533.1267a.8872.8872 0 00-.4646-.1266zm.01 2.2523c.072 0 .1443.0187.209.056l6.5366 3.774c.2789.161.2789.5633 0 .7243l-6.5367 3.774a.4182.4182 0 01-.4182 0L5.26 6.8074c-.2788-.1609-.2789-.5633 0-.7243l6.5368-3.774a.4193.4193 0 01.209-.056zm-8.0801 6.458a.4145.4145 0 01.215.0565l6.524 3.7666a.417.417 0 01.2086.3612v7.5326c0 .3212-.3477.522-.626.3613l-6.5237-3.7666a.4172.4172 0 01-.2086-.3613V9.1288c0-.2408.1955-.414.4107-.4177zm16.1599 0c.215.004.4107.1768.4107.4177v7.5325c0 .149-.08.2868-.2087.3614l-6.5239 3.7666c-.278.1606-.6258-.0401-.6258-.3614v-7.5325c0-.149.08-.2867.2086-.3613l6.5238-3.7666a.415.415 0 01.2152-.0565z" fill="white"></path>
            </svg>
        </a>
        <a href="https://github.com/ashwin232003" target="_blank"><i class="fab fa-github"></i></a>
    </div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">EscapeTwo - Hack the box</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="../../index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="../../Writeup_all.html">Write-up</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Sections -->
    <div class="container">
        <section id="machine-info" class="section">   
            <h2>Machine Info</h2>
            <p>EscapeTwo is an Easy Windows machine focused on Active Directory exploitation. Initial access was gained using provided credentials, leading to the discovery of a read-only accounting department directory containing an XML file with plaintext credentials. Using these, access to an MSSQL service was obtained, <code>xp_cmdshell</code> was enabled, and a shell was uploaded. Enumeration revealed a service account password in a configuration file, which, combined with SeImpersonatePrivilege abuse, led to NT SYSTEM access. The intended path involved password spraying to collect four valid users, analyzing DACL information with SharpHound to find that the <code>ryan</code> account controlled <code>CA_SVC</code>, and exploiting a certificate template misconfiguration to retrieve the administrator‚Äôs NTLM hash.</p>
            <img src="https://labs.hackthebox.com/storage/avatars/d5fcf2425893a73cf137284e2de580e1.png">
        </section>

        <section id="enumeration" class="section">
    <h2>Enumeration</h2>
    <h3>Nmap:</h3>
    <!-- Terminal Window: Rustscan Output -->
    <div class="terminal-window">
        <div class="window-header">
            <span class="button close"></span>
            <span class="button minimize"></span>
            <span class="button maximize"></span>
        </div>
        <div class="terminal">
            <pre><code class="language-bash">nmap -sV -sC 10.129.186.109 -oA nmap/Escapetwo
53/tcp   open  domain        Simple DNS Plus
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)
|_ssl-date: 2025-01-23T03:08:06+00:00; 0s from scanner time.
| ssl-cert: Subject: commonName=DC01.sequel.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::<unsupported>, DNS:DC01.sequel.htb
| Not valid before: 2024-06-08T17:35:00
|_Not valid after:  2025-06-08T17:35:00
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)
|_ssl-date: 2025-01-23T03:08:06+00:00; 0s from scanner time.
| ssl-cert: Subject: commonName=DC01.sequel.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::<unsupported>, DNS:DC01.sequel.htb
| Not valid before: 2024-06-08T17:35:00
|_Not valid after:  2025-06-08T17:35:00
1433/tcp open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM
| ms-sql-info: 
|   10.129.186.109:1433: 
|     Version: 
|       name: Microsoft SQL Server 2019 RTM
|       number: 15.00.2000.00
|       Product: Microsoft SQL Server 2019
|       Service pack level: RTM
|       Post-SP patches applied: false
|_    TCP port: 1433
| ms-sql-ntlm-info: 
|   10.129.186.109:1433: 
|     Target_Name: SEQUEL
|     NetBIOS_Domain_Name: SEQUEL
|     NetBIOS_Computer_Name: DC01
|     DNS_Domain_Name: sequel.htb
|     DNS_Computer_Name: DC01.sequel.htb
|     DNS_Tree_Name: sequel.htb
|_    Product_Version: 10.0.17763
| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback
| Not valid before: 2025-01-23T02:52:38
|_Not valid after:  2055-01-23T02:52:38
|_ssl-date: 2025-01-23T03:08:06+00:00; 0s from scanner time.
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)
|_ssl-date: 2025-01-23T03:08:06+00:00; 0s from scanner time.
| ssl-cert: Subject: commonName=DC01.sequel.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::<unsupported>, DNS:DC01.sequel.htb
| Not valid before: 2024-06-08T17:35:00
|_Not valid after:  2025-06-08T17:35:00
3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)
|_ssl-date: 2025-01-23T03:08:06+00:00; 0s from scanner time.
| ssl-cert: Subject: commonName=DC01.sequel.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::<unsupported>, DNS:DC01.sequel.htb
| Not valid before: 2024-06-08T17:35:00
|_Not valid after:  2025-06-08T17:35:00
5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows
</code></pre>
        </div>
    </div>
    <p>The Nmap scan results reveal an Active Directory environment hosted on <strong>DC01.sequel.htb</strong>, with multiple open ports indicative of a Windows domain controller. Key services include <strong>LDAP (389, 636, 3268, 3269)</strong> for directory services, <strong>SMB (445)</strong> for file sharing, and <strong>MSRPC (135)</strong> for remote procedure calls. The presence of <strong>Microsoft SQL Server (1433)</strong> suggests potential database exploitation vectors. Additionally, <strong>WinRM (5985)</strong> is available, which could facilitate remote command execution if valid credentials are obtained. Notably, <strong>SMB signing is enforced</strong>, which may limit certain attacks. These findings indicate potential attack vectors through <strong>Active Directory enumeration, SMB interactions, SQL exploitation, and WinRM abuse</strong>.</p>    
</section>

<section id="machine-info" class="section">
<p>‚õî This box is still active on HackTheBox. Once retired, this article will be published for public access as per <a href="https://help.hackthebox.com/en/articles/5188925-streaming-writeups-walkthrough-guidelines?ref=benheater.com">HackTheBox's policy</a> on publishing content from their platform.</p>

<p>‚õî For more hints and assistance, come chat with me and the rest of your peers in the <a href="https://discord.gg/s2xTkFNQ">HackTheBox Discord server</a>. Or, you can reach out to me at my other social links in the site footer or site menu.</p>
</section>
<hr>
<section id="Thanks" class="section">
  <h2>Appreciation</h2>
  <p>If my write-up helped you, I‚Äôd really appreciate it if you could show your support! üôè Also, if you like my content, please consider giving me respect on HTB‚Äîyour support truly means a lot! üíö‚ú®</p>

  <div class="htb-badge">
  <a class="htb-badge-thingy" href="https://app.hackthebox.com/profile/1979366">
    <div class="htb-avatar-container">
      <img class="htb-avatar" src="https://labs.hackthebox.com/storage/avatars/12e408c2f1dac32cb34fcfaaab152554.png" alt="Avatar">
    </div>
  </a>
  <div class="htb-info">
    <a class="htb-badge-thingy" href="https://app.hackthebox.com/profile/1979366">
      <p class="htb-line">
        <span class="htb-nickname">4shWIN</span> 
        <span class="htb-rank" id="htb-rank">Hacker</span>
      </p>
      <p class="htb-line">
        <span class="htb-ranking">Rank: <span id="htb-ranking">504</span></span>
        <img src="https://www.hackthebox.com/images/screenshot.png" class="htb-icon" alt="Icon">
        <span class="htb-points" id="htb-points">371</span>
        <img src="https://www.hackthebox.com/images/star.png" class="htb-icon" alt="Star Icon">
        <span class="htb-respect" id="htb-respect">1</span>
      </p>
    </a>
    <p class="htb-line">
      <a href="https://app.hackthebox.com/profile/1979366" class="htb-link">Give me a Respect</a>
    </p>
  </div>
</div>
</section>
<hr>
<section id="Mistake" class="section">
  <h2>Found a Mistake?</h2>
  <p>If you notice any errors or have feedback, feel free to email me at <a href="mailto:ashwin200323@gmail.com">ashwin200323@gmail.com</a>. Thanks for your help!</p>
</section>
    </div>
    <script src="../htb_rank.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
<footer>
  <div class="copyright">
    ¬© 2025 | Ashwin
  </div>
</footer>
</body>
</html>
